{% extends 'index.html' %}
{% load static %}
{% load humanize %}
{% block title %}<title>{{video.title}} - YouTube</title>{% endblock %}
{% block content %}
{% load custom_filters %}
{% include 'hiddensidebar.html' %}

<style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');



    body.dark .main .main-scroll 
    {
        background: #0f0f0f;
    }
    body.dark .videocon .left .title h3
    {
        color: #d0d0d0;
    }
    body.dark .subcon .subleft .subdetail h5
    {
        color: #d2d2d2;
    }
    body.dark .subcon .subleft .subdetail label
    {
        color: #919191;
    }
    body.dark .subcon .subright button
    {
        background: white;
        color: black;
    }
    body.dark .videocon .likecon .con
    {
        background: #272727;
    }
    body.dark .videocon .likecon .con svg
    {
        fill: #d6d6d6;
    }
    body.dark .videocon .likecon .con label
    {
        color: #d6d6d6;
    }
    body.dark .videocon .left .desc
    {
        background: #272727;
        transition: .3s;
        color: #dedede;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }
    body.dark .videocon .left .desc:hover 
    {
        background: #3f3f3f;
        transition: 0.3s;
    }
    body.dark .videocon .left .desc #viewcon
    {
        color: #dedede;
    }
    .videocon .left .desc #viewcon label
    {
        margin-bottom: 10px;
    }
    body.dark .videocon .left .desc p
    {
        color: #dedede;
    }
    body.dark .videocon .left .desc button
    {
        color: #dedede;
    }

    body.dark .commentcount label 
    {
        color: #dedede;
    }
    body.dark .usercomment .userinput input
    {
        color: white;
        border-bottom: 1px solid #1f1f1f;
    }
    body.dark .publicdetail .head a
    {
        color: #dddddd;
    }
    body.dark .publicdetail p
    {
        color: #dddddd;
    }
    body.dark .publicdetail .head span
    {
        color: #aaa;
    }
    body.dark .likescon .like button svg
    {
        fill: #dedede;
    }
    body.dark .likescon .like button label
    {
        color: #dedede;
    }
    body.dark .likescon .reply button
    {
        color: #dedede;
    }
    body.dark .main .main-scroll form button svg 
    {
        fill: #dedede;
    }

    body.dark .right-inner .videos .video .video-detail h4
    {
        color: #dedede;
    }


    *
    {
        margin: 0;
        padding: 0;
        font-family: 'Roboto', sans-serif;
    }
    .main
    {
        width: 100%;
    }
    .main .main-scroll 
    {
        width: 100%;
        background: #ffffff;
    }
    .main .main-scroll .inner 
    {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 0px;
        padding-top: 20px;
    }
    @media (max-width: 1312px){
        .main .main-scroll 
        {
            min-width: 100%;
        }
    }
    
    .videocon 
    {
        width: 85%;
        display: flex;
        align-items: flex-start;
        max-width: 1780px;
    }
    .videocon .left 
    {
        width: 70%;
        background: ;
    
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        padding-bottom: 20px;
    }
    .videocon .left .video-con 
    {
        width: 100%;
        height: 100%;
        position: relative;
    }
    .videocon .left .video-con video
    {
        width: 100%;
    }
    
    .videocon .left .title h3 
    {
        word-break: break-word;
        font-size: 18px;
        line-height: 30px;
        font-weight: 400;
        max-height: 54px;
        overflow: hidden;
        margin-top: 8px;
    }
    .videocon .left .views 
    {
        margin-top: 5px;
    }
    .videocon .left .views span 
    {
        font-size: 14px;
        line-height: 20px;
        font-weight: 500;
    }
    .videocon .left .desc 
    {
        width: 100%;
        margin-top: 5px;
        background: #f2f2f2;
        padding: 8px;
        border-radius: 12px;
    }
    .videocon .left .desc p
    {
        font-size: 14px;
        line-height: 20px;
        font-weight: 400;
        color: #0f0f0f;
        height: 43px;
        background: ;
        overflow: hidden;
    }
    .videocon .left .desc span 
    {
        font-weight: 500;
        font-size: 13px;
        margin-bottom: 8px;
    }
    .videocon .left .desc p.active 
    {
        height: auto;
    }
    .videocon .left .desc button
    {
        background: none;
        border: none;
        padding: 8px 0px 8px 0px;
        cursor: pointer;
        font-size: 12px;
        font-weight: 500;
    }
    
    
    .videocon .likecon 
    {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        padding: 2px 0;
    }
    .videocon .likecon .con 
    {
        display: flex;
        align-items: center;
        margin-right: 3px;
        cursor: pointer;
    }
    .videocon .likecon .con svg 
    {
        width: 1.4em;
        height: 1.4em;
    }
    .videocon .likecon .con label 
    {
        font-size: 14px;
        font-weight: 500;
        margin-left: 2px;
    }
    
    
    
    
    .videocon #right 
    {
        width: 30%;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
    }
    .videocon #right .right-inner
    {
        width: 95%;
    }
    
    .videocon #right .right-inner .videos 
    {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }
    .videocon #right .right-inner .videos .video 
    {
        display: flex;
        align-items: flex-start;
        margin-bottom: 5px;
    }
    .right-inner .videos .video .video-img 
    {
        width: 168px;
        min-width: 168px;
    }
    .right-inner .videos .video .video-img img 
    {
        width: 100%;
        height: 100%;
    }
    .right-inner .videos .video .video-detail
    {
        margin-left: 8px;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        text-align: left;
    }
    .right-inner .videos .video .video-detail h4 
    {
        margin: 0 0 4px 0;
        font-size: 14px;
        line-height: 20px;
        font-weight: 500;
        max-height: 40px;
        overflow: hidden;
    }
    .right-inner .videos .video .video-detail a 
    {
        max-height: 40px;
        overflow: hidden;
        font-size: 12px;
        line-height: 18px;
        font-weight: 400;
        cursor: pointer;
        display: block;
        word-break: break-word;
        color: gray;
        text-decoration: none;
    }
    .right-inner .videos .video .video-detail span 
    {
        font-size: 12px;
        line-height: 18px;
        font-weight: 400;
        color: gray;
        max-height: 20px;
        overflow: hidden;
    }
    
    
    
    
    .subcon 
    {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: flex-start;
        margin: 10px 0;
        border-radius: 3px;
    }
    .subcon .subleft 
    {
        display: flex;
        align-items: center;
    }
    .subcon .subleft .subimg 
    {
        width: 40px;
        height: 40px;
        min-width: 40px;
        border-radius: 50%;
        overflow: hidden;
    }
    .subcon .subleft .subdetail 
    {
        margin-left: 10px;
        max-height: 40px;
        overflow: hidden;
    }
    .subcon .subleft .subdetail h5 
    {
        font-size: 14px;
        font-weight: 500;
        line-height: 20px;
    }
    .subcon .subleft .subdetail label 
    {
        font-size: 12px;
        line-height: 18px;
        font-weight: 400;
        max-height: 18px;
        overflow: hidden;
    }
    .subcon .subleft .subimg img 
    {
        width: 100%;
        height: 100%;
    }
    .subcon .subright 
    {
        margin-left: 30px;
    }
    .subcon .subright .subbutton 
    {
        display: flex;
        align-items: center;
    }
    .subcon .subright button
    {
        padding: 10px 15px;
        background: #000;
        margin: auto 2px;
        white-space: nowrap;
        font-size: 14px;
        border: none;
        font-weight: 500;
        letter-spacing: .5px;
        text-transform: capitalize;
        display: flex;
        flex-direction: row;
        border-radius: 18px;
        color: white;
        cursor: pointer;
    }
    .subcon .subright #subscribed
    {
        background: lightgray;
        color: gray;
    }
    
    
    .usercomment
    {
        width: 100%;
        display: flex;
        align-items: center;
        margin-top: 25px;
        margin-bottom: 10px;
    }
    .usercomment .userimg 
    {
        width: 40px;
        height: 40px;
        min-width: 40px;
        overflow: hidden;
        border-radius: 50%;
        margin-right: 10px;
    }
    .usercomment .userimg img 
    {
        width: 100%;
        height: 100%;
    }
    .usercomment .userinput 
    {
        width: 100%;
        display: flex;
        flex-direction: row;
        align-items: flex-end;
    }
    .usercomment .userinput form 
    {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
    }
    .usercomment .userinput form button
    {
        font-size: 12px;
        font-weight: 400;
        letter-spacing: .5px;
        border-radius: 20px;
        background: #065fd4;
        color: white;
        padding: 9px 10px;
        margin-left: 10px;
    }
    .usercomment .userinput input
    {
        width: 100%;
        border: none;
        outline: none;
        border-bottom: 1px solid lightgray;
        height: 30px;
        background: transparent;
    }
    
    
    
    .publiccomments
    {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        justify-content: flex-start;
        margin-top: 20px;
    }
    .publiccomments .publiccomment
    {
        width: 100%;
        display: flex;
        align-items: flex-start;
        margin-bottom: 20px;
        height: auto;
    }
    .publiccomments .publiccomment .publicimage
    {
        width: 40px;
        height: 40px;
        min-width: 40px;
        margin-right: 10px;
    }
    .publiccomment .publicimg
    {
        width: 40px;
        height: 40px;
        min-width: 40px;
        overflow: hidden;
        border-radius: 50%;
        margin-right: 10px;
    }
    .publiccomment .publicimg img 
    {
        width: 100%;
        height: 100%;
    }
    
    
    
    
    .publiccomment .publicdetail 
    {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }
    .publicdetail .head a
    {
        font-size: 13px;
        margin-right: 4px;
        color: #0f0f0f;
        font-weight: 500;
        line-height: 18px;
        text-decoration: none;
        margin-bottom: 2px;
    }
    .publicdetail .head span 
    {
        color: #606060;
        font-size: 12px;
        line-height: 18px;
        font-weight: 400;
    }
    .publicdetail p 
    {
        color: #0f0f0f;
        line-height: 20px;
        font-size: 14px;
        font-weight: 400;
        overflow-wrap: anywhere;
        margin-top: 4px;
    }
    

    .videocon .bothcon 
    {
        width: 100%;
        display: flex;
        flex-direction: row-reverse;
        align-items: center;
        justify-content: space-between;
    }
    
    
    
    #id_comment_user
    {
        display: none;
    }
    #id_comment_id 
    {
        display: none;
    }
    #id_comment_video
    {
        display: none;
    }
    
    
    @media (max-width: 1016px){
        .videocon
        {
            width: 94%;
        }
        .videocon .left 
        {
            width: 100%;
        }
        .videocon #right 
        {
            width: 100%;
        }
        .videocon
        {
            display: flex;
            flex-direction: column; 
        }
        .videocon #right .right-inner
        {
            width: 100%;
        }
    }


    @media (max-width: 1190px){
        .videocon
        {
            width: 95%;
        }
    }

    @media (max-width: 1570px){
        .videocon .bothcon 
        {
            display: flex;
            flex-direction: column-reverse;
            align-items: flex-start;
        }
        .videocon .likecon
        {
            justify-content: flex-start;
        }
    }


    .likescon 
    {
        width: 100%;
        height: 36px;
        margin-top: 8px;
        display: flex;
        align-items: center;
    }
    .likescon .like 
    {
        height: 25px;
        margin-right: 20px;
    }
    .likescon .like button
    {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        outline: none;
        background: none;
        cursor: pointer;
    }
    .likescon .like button svg 
    {
        width: 1.7em;
        height: 1.7em;
    }
    .likescon .like button label 
    {
        font-size: 13px;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: 3px;
    }
    .likescon .reply button
    {
        background: none;
        border: none;
        outline: none;
        cursor: pointer;
    }
    .likescon .authorlike 
    {
        display: flex;
        align-items: center;
        margin-left: 15px;
    }
    .likescon .authorlike .img 
    {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        position: relative;
    }
    .likescon .authorlike .img img 
    {
        width: 100%;
        height: 100%;
        border-radius: 50%;
    }
    .likescon .authorlike .img svg 
    {
        width: 12px;
        height: 12px;
        fill: crimson;
        position: absolute;
        right: -4px;
        bottom: -5px;
    }
    .publiccomments .commentloader
    {
        width: 100%;
        height: 70px;
        background: ;
        margin-bottom: 8px;
        display: flex;
        justify-content: center;
        display: none;
    }
    .publiccomments .commentloader label 
    {
        width: 30px;
        height: 30px;
        border: 3px solid gray;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        border-top-color: transparent;
    }
    @keyframes spin 
    {
        0% { transform: rotate(0deg);}
        100% {transform: rotate(360deg);}
    }
    #unlike 
    {
        margin-left: 25px;
    }











    
    .video-con {
    position: relative;
    display: flex;
    justify-content: center;
    margin-inline: auto;
    background-color: black;
  }
  
  .video-con.theater,
  .video-con.full-screen {
    max-width: initial;
    width: 100%;
  }
  
  .video-con.theater {
    max-height: 90vh;
  }
  
  .video-con.full-screen {
    max-height: 100vh;
  }
  
  video {
    width: 100%;
  }
  
  .video-controls-container {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    color: white;
    z-index: 1;
    opacity: 0;
    transition: opacity 150ms ease-in-out;
  }
  
  .video-controls-container::before {
    content: "";
    position: absolute;
    bottom: 0;
    background: linear-gradient(to top, rgba(0, 0, 0, .75), transparent);
    width: 100%;
    aspect-ratio: 6 / 1;
    z-index: -1;
    pointer-events: none;
  }
  
  .video-con:hover .video-controls-container,
  .video-con:focus-within .video-controls-container,
  .video-con.paused .video-controls-container {
    opacity: 1;
  }
  
  .video-controls-container .controls {
    display: flex;
    gap: .5rem;
    padding: .25rem;
    align-items: center;
  }
  
  .video-controls-container .controls button {
    background: none;
    border: none;
    color: inherit;
    padding: 0;
    height: 30px;
    width: 30px;
    font-size: 1.1rem;
    cursor: pointer;
    opacity: .85;
    transition: opacity 150ms ease-in-out;
  }
  
  .video-controls-container .controls button:hover {
    opacity: 1;
  }
  
  .video-con.paused .pause-icon {
    display: none;
  }
  
  .video-con:not(.paused) .play-icon {
    display: none;
  }
  
  .video-con.theater .tall {
    display: none;
  }
  
  .video-con:not(.theater) .wide {
    display: none;
  }
  
  .video-con.full-screen .open {
    display: none;
  }
  
  .video-con:not(.full-screen) .close {
    display: none;
  }
  
  .volume-high-icon,
  .volume-low-icon,
  .volume-muted-icon {
    display: none;
  }
  
  .video-con[data-volume-level="high"] .volume-high-icon {
    display: block;
  }
  
  .video-con[data-volume-level="low"] .volume-low-icon {
    display: block;
  }
  
  .video-con[data-volume-level="muted"] .volume-muted-icon {
    display: block;
  }
  
  .volume-container {
    display: flex;
    align-items: center;
  }
  
  .volume-slider {
    width: 0;
    transform-origin: left;
    transform: scaleX(0);
    transition: width 150ms ease-in-out, transform 150ms ease-in-out;
  }
  
  .volume-container:hover .volume-slider,
  .volume-slider:focus-within {
    width: 100px;
    transform: scaleX(1);
  }
  
  .duration-container {
    display: flex;
    align-items: center;
    gap: .25rem;
    flex-grow: 1;
  }
  
  .video-con.captions .captions-btn {
    border-bottom: 3px solid red;
  }
  
  .video-controls-container .controls button.wide-btn {
    width: 50px;
  }
  
  .timeline-container {
    height: 7px;
    margin-inline: .5rem;
    cursor: pointer;
    display: flex;
    align-items: center;
  }
  
  .timeline {
    background-color: rgba(100, 100, 100, .5);
    height: 3px;
    width: 100%;
    position: relative
  }
  
  .timeline::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    right: calc(100% - var(--preview-position) * 100%);
    background-color: rgb(150, 150, 150);
    display: none;
  }
  
  .timeline::after {
    content: "";
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    right: calc(100% - var(--progress-position) * 100%);
    background-color: red;
  }
  
  .timeline .thumb-indicator {
    --scale: 0;
    position: absolute;
    transform: translateX(-50%) scale(var(--scale));
    height: 200%;
    top: -50%;
    left: calc(var(--progress-position) * 100%);
    background-color: red;
    border-radius: 50%;
    transition: transform 150ms ease-in-out;
    aspect-ratio: 1 / 1;
  }
  
  .timeline .preview-img {
    position: absolute;
    height: 80px;
    aspect-ratio: 16 / 9;
    top: -1rem;
    transform: translate(-50%, -100%);
    left: calc(var(--preview-position) * 100%);
    border-radius: .25rem;
    border: 2px solid white;
    display: none;
  }
  
  .thumbnail-img {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
    display: none;
  }
  
  .video-con.scrubbing .thumbnail-img {
    display: block;
  }
  
  .video-con.scrubbing .preview-img,
  .timeline-container:hover .preview-img {
    display: block;
  }
  
  .video-con.scrubbing .timeline::before,
  .timeline-container:hover .timeline::before {
    display: block;
  }
  
  .video-con.scrubbing .thumb-indicator,
  .timeline-container:hover .thumb-indicator {
    --scale: 1;
  }
  
  .video-con.scrubbing .timeline,
  .timeline-container:hover .timeline {
    height: 100%;
  }



    .likescon
    {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        height: auto;
    }
    .likescon .liketop 
    {
        display: flex;
        align-items: center;
    }
    .liketop .like 
    {
        display: flex;
        align-items: center;
    }
    .liketop .reply
    {
        display: flex;
        align-items: center;
    }
    .likebottom
    {
        width: 100%;
        height: auto;
        display: none;
        margin: 5px 0;
    }
    .likebottom.active 
    {
        display: block;
    }

    .likebottom form 
    {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }
    .likebottom form input
    {
        width: 100%;
        height: 35px;
        padding: 0 5px;
        border: none;
        outline: none;
        border-bottom: 1px solid #606060;
        margin-top: 5px;
    }
    .likebottom form div 
    {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: flex-end;
    }
    .likebottom form div a 
    {
        padding: 5px 15px;
        margin-left: 8px;
        margin-top: 8px;
    }
    .likebottom form div button
    {
        padding: 5px 15px;
        margin-left: 8px;
        margin-top: 8px;
    }
    .likebottom form div button:last-child
    {
        background: dodgerblue;
        color: white;
        border-radius: 20px;
    }


    #commentdelete
    {
        position: relative;
    }
    #commentdelete .commentoptions
    {
        width: 80px;
        position: absolute;
        right: 20px;
        bottom: 25px;
        background: white;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        display: none;
    }
    #commentdelete .commentoptions.active 
    {
        display: block;
    }
    #commentdelete .commentoptions a 
    {
        width: 100%;
        padding: 3px 6px;
    }
    .desc span
    {
        cursor: pointer;
    }






</style>



<div class="main-scroll">
    <div class="inner" video-id="{{id}}" onload="comments_load(this)">
        <div class="videocon">
            <div class="left">
                {% if video.video %}
                <div class="video-con paused" data-volume-level="high">
                    <img class="thumbnail-img">
                    <div class="video-controls-container">
                        <div class="timeline-container">
                            <div class="timeline">
                                <div class="thumb-indicator"></div>
                            </div>
                        </div>
                        <div class="controls">
                            <button class="play-pause-btn">
                                <svg class="play-icon" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M8,5.14V19.14L19,12.14L8,5.14Z" />
                                </svg>
                                <svg class="pause-icon" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M14,19H18V5H14M6,19H10V5H6V19Z" />
                                </svg>
                            </button>
                            <div class="volume-container">
                                <button class="mute-btn">
                                    <svg class="volume-high-icon" viewBox="0 0 24 24">
                                        <path fill="currentColor" d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z" />
                                    </svg>
                                    <svg class="volume-low-icon" viewBox="0 0 24 24">
                                        <path fill="currentColor" d="M5,9V15H9L14,20V4L9,9M18.5,12C18.5,10.23 17.5,8.71 16,7.97V16C17.5,15.29 18.5,13.76 18.5,12Z" />
                                    </svg>
                                    <svg class="volume-muted-icon" viewBox="0 0 24 24">
                                        <path fill="currentColor" d="M12,4L9.91,6.09L12,8.18M4.27,3L3,4.27L7.73,9H3V15H7L12,20V13.27L16.25,17.53C15.58,18.04 14.83,18.46 14,18.7V20.77C15.38,20.45 16.63,19.82 17.68,18.96L19.73,21L21,19.73L12,10.73M19,12C19,12.94 18.8,13.82 18.46,14.64L19.97,16.15C20.62,14.91 21,13.5 21,12C21,7.72 18,4.14 14,3.23V5.29C16.89,6.15 19,8.83 19,12M16.5,12C16.5,10.23 15.5,8.71 14,7.97V10.18L16.45,12.63C16.5,12.43 16.5,12.21 16.5,12Z" />
                                    </svg>
                                </button>
                                <input class="volume-slider" type="range" min="0" max="1" step="any" value="1">
                            </div>
                            <div class="duration-container">
                                <div class="current-time">0:00</div>
                                /
                                <div class="total-time"></div>
                            </div>
                            <button class="captions-btn">
                                <svg viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M18,11H16.5V10.5H14.5V13.5H16.5V13H18V14A1,1 0 0,1 17,15H14A1,1 0 0,1 13,14V10A1,1 0 0,1 14,9H17A1,1 0 0,1 18,10M11,11H9.5V10.5H7.5V13.5H9.5V13H11V14A1,1 0 0,1 10,15H7A1,1 0 0,1 6,14V10A1,1 0 0,1 7,9H10A1,1 0 0,1 11,10M19,4H5C3.89,4 3,4.89 3,6V18A2,2 0 0,0 5,20H19A2,2 0 0,0 21,18V6C21,4.89 20.1,4 19,4Z" />
                                </svg>
                            </button>
                            <button class="speed-btn wide-btn">
                                1x
                            </button>
                            <button class="mini-player-btn">
                                <svg viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M21 3H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H3V5h18v14zm-10-7h9v6h-9z"/>
                                </svg>
                            </button>
                            <button class="theater-btn">
                                <svg class="tall" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M19 6H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 10H5V8h14v8z"/>
                                </svg>
                                <svg class="wide" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M19 7H5c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2zm0 8H5V9h14v6z"/>
                                </svg>
                            </button>
                            <button class="full-screen-btn">
                                <svg class="open" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
                                </svg>
                                <svg class="close" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    {% if video.video %}
                        <video src="{{video.video.url}}" id="videosrcurl" autoplay unmuted loop>
                            <track kind="captions" srclang="en" src="">
                        </video>
                    {% else %}
                        Video Doesn't Exist
                    {% endif %}
                </div>
                {% else %}
                    <div style="width: 100%; height: 420px; display: flex; align-items: center; justify-content: center; background: black; color: white;">
                        <label>Video doesn't exist</label>
                    </div>
                {% endif %}
                <div class="title">
                    <h3>{{video.title}}</h3>
                </div>
                {% comment %} <div class="views">
                    <span>{{video.views}} views {{video.published | date:"M d, Y"}}</span>
                </div> {% endcomment %}
                <div class="bothcon">
                    <div class="likecon">
                        {% if request.user in video.liked.all %}
                            <div class="con like" onclick="unlike_video(this)" data-video_id="{{video.id}}">
                                <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M3,11h3v10H3V11z M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11v10h10.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z" class="style-scope yt-icon"></path></g></svg>
                                <label>{{video.liked.all.count}}</label>
                                {% comment %} <svg id="unlike" viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M17,4h-1H6.57C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21 c0.58,0,1.14-0.24,1.52-0.65L17,14h4V4H17z M10.4,19.67C10.21,19.88,9.92,20,9.62,20c-0.26,0-0.5-0.11-0.63-0.3 c-0.07-0.1-0.15-0.26-0.09-0.47l1.52-4.94l0.4-1.29H9.46H5.23c-0.41,0-0.8-0.17-1.03-0.46c-0.12-0.15-0.25-0.4-0.18-0.72l1.34-6 C5.46,5.35,5.97,5,6.57,5H16v8.61L10.4,19.67z M20,13h-3V5h3V13z" class="style-scope yt-icon"></path></g></svg> {% endcomment %}
                            </div>
                        {% else %}
                            <div class="con like" onclick="like_video(this)" data-video_id="{{video.id}}">
                                <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon"></path></g></svg>
                                <label>{{video.liked.all.count}}</label>
                                {% comment %} <svg id="unlike" viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M17,4h-1H6.57C5.5,4,4.59,4.67,4.38,5.61l-1.34,6C2.77,12.85,3.82,14,5.23,14h4.23l-1.52,4.94C7.62,19.97,8.46,21,9.62,21 c0.58,0,1.14-0.24,1.52-0.65L17,14h4V4H17z M10.4,19.67C10.21,19.88,9.92,20,9.62,20c-0.26,0-0.5-0.11-0.63-0.3 c-0.07-0.1-0.15-0.26-0.09-0.47l1.52-4.94l0.4-1.29H9.46H5.23c-0.41,0-0.8-0.17-1.03-0.46c-0.12-0.15-0.25-0.4-0.18-0.72l1.34-6 C5.46,5.35,5.97,5,6.57,5H16v8.61L10.4,19.67z M20,13h-3V5h3V13z" class="style-scope yt-icon"></path></g></svg> {% endcomment %}
                            </div>
                        {% endif %}
                        <div class="con share">
                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g mirror-in-rtl="" class="style-scope yt-icon"><path d="M15,5.63L20.66,12L15,18.37V15v-1h-1c-3.96,0-7.14,1-9.75,3.09c1.84-4.07,5.11-6.4,9.89-7.1L15,9.86V9V5.63 M14,3v6 C6.22,10.13,3.11,15.33,2,21c2.78-3.97,6.44-6,12-6v6l8-9L14,3L14,3z" class="style-scope yt-icon"></path></g></svg>
                            <label>Share</label>
                        </div>
                        <div class="con thanks">
                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M16.5,3C19.02,3,21,5.19,21,7.99c0,3.7-3.28,6.94-8.25,11.86L12,20.59l-0.74-0.73l-0.04-0.04C6.27,14.92,3,11.69,3,7.99 C3,5.19,4.98,3,7.5,3c1.4,0,2.79,0.71,3.71,1.89L12,5.9l0.79-1.01C13.71,3.71,15.1,3,16.5,3 M16.5,2c-1.74,0-3.41,0.88-4.5,2.28 C10.91,2.88,9.24,2,7.5,2C4.42,2,2,4.64,2,7.99c0,4.12,3.4,7.48,8.55,12.58L12,22l1.45-1.44C18.6,15.47,22,12.11,22,7.99 C22,4.64,19.58,2,16.5,2L16.5,2z M11.33,10.86c0.2,0.14,0.53,0.26,1,0.36c0.47,0.1,0.86,0.22,1.18,0.35 c0.99,0.4,1.49,1.09,1.49,2.07c0,0.7-0.28,1.27-0.83,1.71c-0.33,0.26-0.73,0.43-1.17,0.54V17h-2v-1.16 c-0.18-0.05-0.37-0.1-0.53-0.19c-0.46-0.23-0.92-0.55-1.18-0.95C9.15,14.48,9.06,14.24,9,14h2c0.05,0.09,0.07,0.18,0.15,0.25 c0.23,0.19,0.54,0.29,0.92,0.29c0.36,0,0.63-0.07,0.82-0.22s0.28-0.35,0.28-0.59c0-0.25-0.11-0.45-0.34-0.6s-0.59-0.27-1.1-0.39 c-1.67-0.39-2.51-1.16-2.51-2.34c0-0.68,0.26-1.26,0.78-1.71c0.28-0.25,0.62-0.43,1-0.54V7h2v1.12c0.46,0.11,0.85,0.29,1.18,0.57 C14.59,9.05,14.9,9.48,15,10h-2c-0.04-0.09-0.1-0.17-0.16-0.24c-0.17-0.19-0.44-0.29-0.81-0.29c-0.32,0-0.56,0.08-0.74,0.24 c-0.17,0.16-0.26,0.36-0.26,0.6C11.03,10.53,11.13,10.72,11.33,10.86z" class="style-scope yt-icon"></path></g></svg>
                            <label>Thanks</label>
                        </div>
                        <div class="con clip">
                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M8,7c0,0.55-0.45,1-1,1S6,7.55,6,7c0-0.55,0.45-1,1-1S8,6.45,8,7z M7,16c-0.55,0-1,0.45-1,1c0,0.55,0.45,1,1,1s1-0.45,1-1 C8,16.45,7.55,16,7,16z M10.79,8.23L21,18.44V20h-3.27l-5.76-5.76l-1.27,1.27C10.89,15.97,11,16.47,11,17c0,2.21-1.79,4-4,4 c-2.21,0-4-1.79-4-4c0-2.21,1.79-4,4-4c0.42,0,0.81,0.08,1.19,0.2l1.37-1.37l-1.11-1.11C8,10.89,7.51,11,7,11c-2.21,0-4-1.79-4-4 c0-2.21,1.79-4,4-4c2.21,0,4,1.79,4,4C11,7.43,10.91,7.84,10.79,8.23z M10.08,8.94L9.65,8.5l0.19-0.58C9.95,7.58,10,7.28,10,7 c0-1.65-1.35-3-3-3S4,5.35,4,7c0,1.65,1.35,3,3,3c0.36,0,0.73-0.07,1.09-0.21L8.7,9.55l0.46,0.46l1.11,1.11l0.71,0.71l-0.71,0.71 L8.9,13.91l-0.43,0.43l-0.58-0.18C7.55,14.05,7.27,14,7,14c-1.65,0-3,1.35-3,3c0,1.65,1.35,3,3,3s3-1.35,3-3 c0-0.38-0.07-0.75-0.22-1.12l-0.25-0.61L10,14.8l1.27-1.27l0.71-0.71l0.71,0.71L18.15,19H20v-0.15L10.08,8.94z M17.73,4H21v1.56 l-5.52,5.52l-2.41-2.41L17.73,4z M18.15,5l-3.67,3.67l1,1L20,5.15V5H18.15z" class="style-scope yt-icon"></path></g></svg>
                            <label>Clip</label>
                        </div>
                        <div class="con save">
                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M22,13h-4v4h-2v-4h-4v-2h4V7h2v4h4V13z M14,7H2v1h12V7z M2,12h8v-1H2V12z M2,16h8v-1H2V16z" class="style-scope yt-icon"></path></g></svg>
                            <label>Save</label>
                        </div>
                        <div class="con report">
                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M13.18,4l0.24,1.2L13.58,6h0.82H19v7h-5.18l-0.24-1.2L13.42,11H12.6H6V4H13.18 M14,3H5v18h1v-9h6.6l0.4,2h7V5h-5.6L14,3 L14,3z" class="style-scope yt-icon"></path></g></svg>
                            <label>Report</label>
                        </div>
                    </div>
                    <div class="subcon">
                        <div class="subleft">
                            <div class="subimg">
                                {% if request.user == video.author %}
                                    <a href="{% url 'channel' request.user.channeluser.id %}"><img src="{% static 'images/author.png' %}" data-real-src="{{video.author.channeluser.channelimg.url}}"></a>
                                {% else %}
                                    <a href="{% url 'author_channel' video.author.channeluser.channelname %}"><img src="{% static 'images/author.png' %}" data-real-src="{{video.author.channeluser.channelimg.url}}"></a>
                                {% endif %}
                            </div>
                            <div class="subdetail">
                                <h5>{{video.author.channeluser.channelname}}</h5>
                                <label><span>{{video.author.channeluser.subscribers.all.count}}</span> subscribers</label>
                            </div>
                        </div>
                        <div class="subright">
                            {% if video.author == request.user %}
                                <div class="subbutton">
                                    <button>Analytics</button>
                                    <button>Edit video</button>
                                </div>
                            {% else %}
                                <div class="subbutton">
                                    <button style="margin-right: 8px;">Join</button>
                                    {% if request.user in video.author.channeluser.subscribers.all %}
                                        <button onclick="watchunsub(this)" data-channel_id="{{video.author.channeluser.channelname}}" id="subscribed" data-video_id="{{video.id}}">Subscribed</button>
                                    {% else %}
                                        <button onclick="watchsub(this)" data-channel_id="{{video.author.channeluser.channelname}}" data-video_id="{{video.id}}">Subscribe</button>
                                    {% endif %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="desc">
                    <span id="viewcon">{{video.views|format_views_as_comma}} views &bull;&nbsp;<label>{{video.published|time_ago}}</label></span>
                    {% if video.description %}
                    <span style="margin-bottom: 8px;">{{video.description | safe | linebreaks}}</span>
                    {% else %}
                        <span style="margin-bottom: 8px;">
                            <p>No Description</p>
                    </span>
                    {% endif %}
                    <button></button>
                </div>
                <div class="commentcount" style="margin-top: 20px;">
                    <label><span>{{comments.count}}</span> Comments</label>
                </div>
                <div class="usercomment">
                    <div class="userimg">
                        <img src="{% static 'images/author.png' %}" data-real-src="{{request.user.channeluser.channelimg.url}}">
                        {{commentform.comment_id}}
                    </div>
                    <div class="userinput">
                        <form action="{% url 'watch' video.id %}" method="POST" id="commentform">
                            {% csrf_token %}
                            
                            {% comment %} {{commentform.id}} {% endcomment %}
                            {% comment %} {{commentform.comment_id}} {% endcomment %}
                            {{commentform.comment_video}}
                            {{commentform.comment_user}}
                            {{commentform.comment_body}}
                            {{commentform.commented_on}}
                            {% comment %} <button type="submit">COMMENT</button> {% endcomment %}
                        </form>
                    </div>
                </div>



                <div class="publiccomments">
                    <div class="commentloader">
                        <label></label>
                    </div>
                    {% if comments %}
                    {% comment %} <div class="jsoncomments">{{jsoncom}}</div> {% endcomment %}
                        {% for comment in comments %}
                            {% if comment.is_parent %}
                                <div class="publiccomment">
                                    <div class="publicimg">
                                        <img src="{% static 'images/author.png' %}" data-real-src="{{comment.comment_user.channeluser.channelimg.url}}">
                                    </div>
                                    <div class="publicdetail">
                                        <div class="head">
                                            {% if video.author  == comment.comment_user %}
                                                <a href="{% url 'channel' request.user.channeluser.id %}" style="background: rgba(0,0,0,0.6); color: white; padding: 2px 5px; border-radius: 20px;">{{comment.comment_user.channeluser.channelname}}</a>
                                            {% else %}
                                                <a href="{% url 'author_channel' comment.comment_user.channeluser.channelname %}">{{comment.comment_user.channeluser.channelname}}</a>
                                            {% endif %}
                                            <span>{{comment.commented_on|time_ago}}</span>
                                        </div>
                                        <p>{{comment.comment_body}}</p>
                                        <div class="likescon" data-video="{{video.id}}" data-comment="{{comment.comment_id}}">
                                            <div class="liketop">
                                                <div class="like">
                                                    {% if request.user in comment.comment_like.all %}
                                                        <button onclick="unlikecomment(this)">
                                                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 100%; height: 100%;"><g class="style-scope yt-icon"><path d="M3,11h3v10H3V11z M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11v10h10.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z" class="style-scope yt-icon"></path></g></svg>
                                                            <label>{{comment.comment_like.all.count}}</label>
                                                        </button>
                                                    {% else %}
                                                        <button onclick="likecomment(this)">
                                                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon"></path></g></svg>
                                                            <label>{{comment.comment_like.all.count}}</label>
                                                        </button>
                                                    {% endif %}
                                                </div>
                                                <div class="reply">
                                                    <button id="replybtn">Reply</button>
                                                </div>
                                                {% if comment.comment_liked %}
                                                    <div class="authorlike">
                                                        <div class="img">
                                                            <img src="{% static 'images/author.png' %}" data-real-src="{{video.author.channeluser.channelimg.url}}" width="20px">
                                                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M16.5,2c-1.74,0-3.41,0.88-4.5,2.28C10.91,2.88,9.24,2,7.5,2C4.42,2,2,4.64,2,7.99c0,4.12,3.4,7.48,8.55,12.58L12,22 l1.45-1.44C18.6,15.47,22,12.11,22,7.99C22,4.64,19.58,2,16.5,2z" class="style-scope yt-icon"></path></g></svg>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                            </div>
                                            <div class="likebottom">
                                                {% comment %} <form action="" method="POST" id="commentreplyform">
                                                    {% csrf_token %}
                                                    {{commentform.comment_id}}
                                                    {{commentform.comment_user}}
                                                    {{commentform.comment_video}}
                                                    {{commentform.comment_body}}
                                                    {{commentform.parent}}
                                                    <div>
                                                        <a id="cancel">Cancel</a>
                                                        <button type="submit">Reply</button>
                                                    </div>
                                                </form> {% endcomment %}
                                            </div>
                                        </div>
                                    </div>
                                    <form id="commentdelete">
                                        <button style="border: none; background: none; outline: none; cursor: pointer;">
                                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; width: 24px; height: 24px;"><g class="style-scope yt-icon"><path d="M12,16.5c0.83,0,1.5,0.67,1.5,1.5s-0.67,1.5-1.5,1.5s-1.5-0.67-1.5-1.5S11.17,16.5,12,16.5z M10.5,12 c0,0.83,0.67,1.5,1.5,1.5s1.5-0.67,1.5-1.5s-0.67-1.5-1.5-1.5S10.5,11.17,10.5,12z M10.5,6c0,0.83,0.67,1.5,1.5,1.5 s1.5-0.67,1.5-1.5S12.83,4.5,12,4.5S10.5,5.17,10.5,6z" class="style-scope yt-icon"></path></g></svg>
                                        </button>
                                        <div class="commentoptions">
                                            {% if comment.comment_user != request.user %}
                                            <a href="#">Report</a>
                                            {% else %}
                                            <a id="deletecommentbtn" onclick="deletecommentfun(this)">Delete</a>
                                        {% endif %}
                                        </div>
                                    </form>
                                </div>
                                {% for child in comment.children %}
                                    <div class="publiccomment" style="width: 100%; display: flex; align-items: flex-start; justify-content: flex-end;">
                                        <div class="publicimage"></div>
                                        <div class="publicimg" style="width: 24px; height: 24px; min-width: 24px;">
                                            <img src="{% static 'images/author.png' %}" data-real-src="{{child.comment_user.channeluser.channelimg.url}}">
                                        </div>
                                        <div class="publicdetail" style="">
                                            <div class="head">
                                                {% if video.author  == child.comment_user %}
                                                    <a href="{% url 'channel' request.user.channeluser.id %}" style="background: rgba(0,0,0,0.6); color: white; padding: 2px 5px; border-radius: 20px;">{{child.comment_user.channeluser.channelname}}</a>
                                                {% else %}
                                                    <a href="{% url 'author_channel' child.comment_user.channeluser.channelname %}">{{child.comment_user.channeluser.channelname}}</a>
                                                {% endif %}
                                                <span>{{child.commented_on|time_ago}}</span>
                                            </div>
                                            <p>{{child.comment_body}}</p>
                                            {% comment %} <div class="likescon" data-video="{{video.id}}" data-comment="{{child.pk}}">
                                                <div class="like">
                                                    {% if request.user in comment.comment_like.all %}
                                                        <button onclick="unlikecomment(this)">
                                                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 100%; height: 100%;"><g class="style-scope yt-icon"><path d="M3,11h3v10H3V11z M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11v10h10.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z" class="style-scope yt-icon"></path></g></svg>
                                                            <label>{{comment.comment_like.all.count}}</label>
                                                        </button>
                                                    {% else %}
                                                        <button onclick="likecomment(this)">
                                                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon"></path></g></svg>
                                                            <label>{{comment.comment_like.all.count}}</label>
                                                        </button>
                                                    {% endif %}
                                                </div>
                                                <div class="reply">
                                                    <button>Reply</button>
                                                </div>
                                                {% if comment.comment_liked %}
                                                    <div class="authorlike">
                                                        <div class="img">
                                                            <img src="{{video.author.channeluser.channelimg.url}}" width="20px">
                                                            <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M16.5,2c-1.74,0-3.41,0.88-4.5,2.28C10.91,2.88,9.24,2,7.5,2C4.42,2,2,4.64,2,7.99c0,4.12,3.4,7.48,8.55,12.58L12,22 l1.45-1.44C18.6,15.47,22,12.11,22,7.99C22,4.64,19.58,2,16.5,2z" class="style-scope yt-icon"></path></g></svg>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                            </div> {% endcomment %}
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
            <div class="right" id="right">
                <div class="right-inner">
                    <div class="videos">
                        {% for vid in videos %}
                            
                                    <div class="video">
                                        <a href="{% url 'watch' vid.id %}">
                                        <div class="video-img">
                                            <img src="{% static 'images/placeholder.jpg' %}" data-real-src="{{vid.image.url}}">
                                            <span id="videourl">
                                                <p>{{vid.duration}}</p>
                                            </span>
                                        </div>
                                        <div class="video-detail">
                                            <h4>{{vid.title}}</h4>
                                            <a href="#">{{vid.author.channeluser.channelname}}</a>
                                            <span><label>{{vid.views|format_views_as_K}} views</label> &bull; <label>{{vid.published|time_ago}}</label></span>
                                        </div>
                                    </a>
                                    </div>
                                
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>

<script type="text/javascript">
    var descbutton = document.querySelector('.desc button');
    var desc = document.querySelector('.desc p');
    var descover = document.querySelector('.desc');
    descover.addEventListener('click', function(){
        descbutton.click();
    })
    descbutton.addEventListener('click', function(){
        desc.classList.toggle('active');
        if(descbutton.innerHTML == ''){
            descbutton.innerHTML = 'SHOW LESS';
        } else {
            descbutton.innerHTML = '';
        }
    })    

    var comment_user = document.getElementById('id_comment_user');
    comment_user.value = "{{request.user.id}}";

    var comment_video = document.getElementById('id_comment_video');
    comment_video.value = "{{video.id}}";

    var commentdeletes = document.querySelectorAll('#commentdelete');
    if(commentdeletes){
        for(let i=0; i<commentdeletes.length; i++){
            commentdeletes[i].addEventListener('submit', function(e){
                e.preventDefault();
            })
        }
    }
    
    var commentoptions = document.querySelectorAll('.commentoptions');

    var commentoptionsbtn = document.querySelectorAll('#commentdelete button');

    commentoptionsbtn.forEach((button, index) => {
        button.addEventListener('click', () => {

            if(button.classList.contains('active')){
                button.classList.remove('active');
                commentoptions[index].classList.remove('active');
            } else {
                commentoptionsbtn.forEach(btn => btn.classList.remove('active'));
                commentoptions.forEach(content => content.classList.remove('active'));

                button.classList.add('active');
                commentoptions[index].classList.add('active');
            }
        })
    })

    


    function commentopt(element){
        var elem = element.parentElement.querySelector('.commentoptions');
        elem.classList.toggle('active');
    }



    function watchsub(element){
        let name = element.dataset.channel_id;
        let id = element.dataset.video_id;

        fetch(id+'/'+name +'/subscribe', {
            method: 'POST',
            headers: {
                'Content-Type':'application/json',
                "X-CSRFToken": csrftoken,
            }
        })
        .then((res) => {
            var count = element.parentElement.parentElement.parentElement.querySelector('.subleft .subdetail label span');
            var value = count.innerHTML;
            value++;
            count.innerHTML = value;
            element.setAttribute('id', 'subscribed');
            element.innerHTML = 'Subscribed';
            element.insertAdjacentHTML('afterend', '<svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M10,20h4c0,1.1-0.9,2-2,2S10,21.1,10,20z M20,17.35V19H4v-1.65l2-1.88v-5.15c0-2.92,1.56-5.22,4-5.98V3.96 c0-1.42,1.49-2.5,2.99-1.76C13.64,2.52,14,3.23,14,3.96l0,0.39c2.44,0.75,4,3.06,4,5.98v5.15L20,17.35z M19,17.77l-2-1.88v-5.47 c0-2.47-1.19-4.36-3.13-5.1c-1.26-0.53-2.64-0.5-3.84,0.03C8.15,6.11,7,7.99,7,10.42v5.47l-2,1.88V18h14V17.77z" class="style-scope yt-icon"></path></g></svg>');
            element.setAttribute('onclick', 'watchunsub(this)');
        })
        .catch(error => {
            if(error.status > 200){
                throw(error);
            }
        })
    }
    function watchunsub(element){
        let name = element.dataset.channel_id;
        let id = element.dataset.video_id;

            fetch(id+'/'+name+'/unsubscribe', {
                method: 'POST',
                //credentials: 'same-origin',
                headers: {
                    'Content-Type':'application/json',
                    "X-CSRFToken": csrftoken,
                }
            })
            .then((res) => {
                var count = element.parentElement.parentElement.parentElement.querySelector('.subleft .subdetail label span');
                var value = count.innerHTML;
                value--;
                count.innerHTML = value;
                element.removeAttribute('id', 'subscribed');
                element.innerHTML = 'Subscribe';
                
                element.setAttribute('onclick', 'watchsub(this)');
            })
            .catch(error => {
                if(error.status > 200){
                    throw(error);
                }
            })
    }
    function comment(){
        var commentform = document.getElementById('commentform');

        commentform.addEventListener('submit', function(e){
            e.preventDefault();

            var comment_video = document.getElementById("id_comment_video");
            var comment_video_id = "{{video.id}}";
            var comment_user = document.getElementById('id_comment_user');
            var comment_body = document.getElementById('id_comment_body');
            var comment_id = document.getElementById('id_comment_id');
            var csrf = document.getElementsByName("csrfmiddlewaretoken");

            var currentuser = "{{request.user}}";
            
            var channelimg = "{{request.user.channeluser.channelimg.url}}";
            var channelname = "{{request.user.channeluser.channelname}}";
            var url = commentform.getAttribute('action');
            const fd = new FormData();
            const date = new Date();
            var month = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            

            fd.append('comment_video', comment_video.value);
            fd.append('comment_user', comment_user.value);
            fd.append('comment_body', comment_body.value);
            fd.append('comment_id', comment_id.value);
            fd.append('csrfmiddlewaretoken', csrf[0].value);


            
                $.ajax({
                    method: "POST",
                    url: url,
                    data: fd,
                    datatype: 'json',
                    success: function(res){
                        var publiccomments = commentform.parentElement.parentElement.parentElement.querySelector('.publiccomments')
                        var output;
                        commentloader = document.querySelector('.publiccomments .commentloader');

                        output = `
                        <div class="publiccomment">
                            <div class="publicimg">
                                <img src="${channelimg}">
                            </div>
                            <div class="publicdetail">
                                <div class="head">
                                    <a href="#">${channelname}</a>
                                    <span>${humanized_time_span(date.toLocaleString())}</span>
                                </div>
                                <p>${comment_body.value}</p>
                                <div class="likescon" data-video="${comment_video_id}" data-comment="${comment_id.value}">
                                    <div class="liketop">
                                        <div class="like">
                                            <button onclick="likecomment(this)">
                                                <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M18.77,11h-4.23l1.52-4.94C16.38,5.03,15.54,4,14.38,4c-0.58,0-1.14,0.24-1.52,0.65L7,11H3v10h4h1h9.43 c1.06,0,1.98-0.67,2.19-1.61l1.34-6C21.23,12.15,20.18,11,18.77,11z M7,20H4v-8h3V20z M19.98,13.17l-1.34,6 C18.54,19.65,18.03,20,17.43,20H8v-8.61l5.6-6.06C13.79,5.12,14.08,5,14.38,5c0.26,0,0.5,0.11,0.63,0.3 c0.07,0.1,0.15,0.26,0.09,0.47l-1.52,4.94L13.18,12h1.35h4.23c0.41,0,0.8,0.17,1.03,0.46C19.92,12.61,20.05,12.86,19.98,13.17z" class="style-scope yt-icon"></path></g></svg>
                                                <label>0</label>
                                            </button>
                                        </div>
                                        <div class="reply">
                                            <button id="replybtn" onclick="commentreplyshow(this)">Reply</button>
                                        </div>
                                    </div>
                                    <div class="likebottom likebottomi">
                                        <form action="#">
                                            <input type="text" placeholder="Add a reply">
                                            <div>
                                                <a id="cancel" onclick="commentcancelbtn(this)">Cancel</a>
                                                <button type="submit">Reply</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <form id="commentdelete" onsubmit="formsubmit(this)">
                                <a onclick="commentopt(this)" style="border: none; background: none; outline: none; cursor: pointer;">
                                    <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; width: 24px; height: 24px;"><g class="style-scope yt-icon"><path d="M12,16.5c0.83,0,1.5,0.67,1.5,1.5s-0.67,1.5-1.5,1.5s-1.5-0.67-1.5-1.5S11.17,16.5,12,16.5z M10.5,12 c0,0.83,0.67,1.5,1.5,1.5s1.5-0.67,1.5-1.5s-0.67-1.5-1.5-1.5S10.5,11.17,10.5,12z M10.5,6c0,0.83,0.67,1.5,1.5,1.5 s1.5-0.67,1.5-1.5S12.83,4.5,12,4.5S10.5,5.17,10.5,6z" class="style-scope yt-icon"></path></g></svg>
                                </a>
                                <div class="commentoptions">
                                    {% if comment_user != currentuser %}
                                        <a href="#">Report</a>
                                    {% else %}
                                        <a id="deletecommentbtn" onclick="deletecommentfun(this)">Delete</a>
                                    {% endif %}
                                </div>
                            </form>
                        </div>
                        `;

                        if(publiccomments.querySelector('.publiccomment'))
                        {
                            commentloader.style.display = 'flex';
                            setTimeout(function(){
                                commentloader.style.display = 'none';
                                publiccomments.querySelector('.publiccomment').insertAdjacentHTML('beforebegin', output);    
                            }, 2000)
                        } else {
                            commentloader.style.display = 'flex';
                            setTimeout(function(){
                                commentloader.style.display = 'none';
                                publiccomments.innerHTML += output;
                            }, 2000)
                        }

                        setTimeout(function(){
                            var commentcount = commentform.parentElement.parentElement.parentElement.querySelector('.commentcount label span');
                            var value = commentcount.innerHTML;
                            value++;
                            commentcount.innerHTML = value;
                        }, 2500)
                        
                        comment_body.value = '';
                        comment_id.value = uniqueId();
                    },
                    error: function(error){
                        console.log(error);
                    },
                    cache: false,
                    contentType: false,
                    processData: false,
                })
        })
    }
    comment();

    /* $('#commentform').submit(function(event) {
        event.preventDefault();
        
        var formDataArray = $(this).serializeArray(); // Serialize the form data
        var url = $(this).attr('action');
        // Deserialize the serialized data into an object
        var formDataObject = {};
        formDataArray.forEach(function(field) {
            formDataObject[field.name] = field.value;
        });

        var commentBody = formDataArray;
        console.log(commentBody);
        
        $.ajax({
            type: 'POST',
            url: url,  // Update with your Django view URL
            data: formDataArray,
            success: function(response) {
            },
            error: function(error) {
                console.log(error);
            }
        });
    });*/

    const uniqueId = (length=16) => {
        return parseInt(Math.ceil(Math.random() * Date.now()).toPrecision(length).toString().replace(".", ""))
    }


    function qwe(){
        var replybtni = document.querySelectorAll('#replybtni');
        var likebottomi = document.querySelectorAll('.likebottomi');
        for(let i=0; i<replybtni.length; i++){
            replybtni[i].onclick = function(){
                likebottomi[i].classList.toggle('active');
            }
        }
    }



    function formsubmit(e){
        e.preventDefault();
    }

    const playPauseBtn = document.querySelector(".play-pause-btn")
    const theaterBtn = document.querySelector(".theater-btn")
    const fullScreenBtn = document.querySelector(".full-screen-btn")
    const miniPlayerBtn = document.querySelector(".mini-player-btn")
    const muteBtn = document.querySelector(".mute-btn")
    const captionsBtn = document.querySelector(".captions-btn")
    const speedBtn = document.querySelector(".speed-btn")
    const currentTimeElem = document.querySelector(".current-time")
    const totalTimeElem = document.querySelector(".total-time")
    const previewImg = document.querySelector(".preview-img")
    const thumbnailImg = document.querySelector(".thumbnail-img")
    const volumeSlider = document.querySelector(".volume-slider")
    const videoContainer = document.querySelector(".video-con")
    const timelineContainer = document.querySelector(".timeline-container")
    const video = document.querySelector("video")
    
    document.addEventListener("keydown", e => {
      const tagName = document.activeElement.tagName.toLowerCase()
    
      if (tagName === "input") return
    
      switch (e.key.toLowerCase()) {
        case " ":
          if (tagName === "button") return
        case "k":
          togglePlay()
          break
        case "f":
          toggleFullScreenMode()
          break
        case "t":
          toggleTheaterMode()
          break
        case "i":
          toggleMiniPlayerMode()
          break
        case "m":
          toggleMute()
          break
        case "arrowleft":
        case "j":
          skip(-5)
          break
        case "arrowright":
        case "l":
          skip(5)
          break
        case "c":
          toggleCaptions()
          break
      }
    })
    
    // Timeline
    timelineContainer.addEventListener("mousemove", handleTimelineUpdate)
    timelineContainer.addEventListener("mousedown", toggleScrubbing)
    document.addEventListener("mouseup", e => {
      if (isScrubbing) toggleScrubbing(e)
    })
    document.addEventListener("mousemove", e => {
      if (isScrubbing) handleTimelineUpdate(e)
    })
    
    let isScrubbing = false
    let wasPaused
    function toggleScrubbing(e) {
      const rect = timelineContainer.getBoundingClientRect()
      const percent = Math.min(Math.max(0, e.x - rect.x), rect.width) / rect.width
      isScrubbing = (e.buttons & 1) === 1
      videoContainer.classList.toggle("scrubbing", isScrubbing)
      if (isScrubbing) {
        wasPaused = video.paused
        video.pause()
      } else {
        video.currentTime = percent * video.duration
        if (!wasPaused) video.play()
      }
    
      handleTimelineUpdate(e)
    }
    
    function handleTimelineUpdate(e) {
      /*const rect = timelineContainer.getBoundingClientRect()
      const percent = Math.min(Math.max(0, e.x - rect.x), rect.width) / rect.width
      const previewImgNumber = Math.max(
        1,
        Math.floor((percent * video.duration) / 10)
      )
      const previewImgSrc = `assets/previewImgs/preview${previewImgNumber}.jpg`
      previewImg.src = previewImgSrc
      timelineContainer.style.setProperty("--preview-position", percent)
    
      if (isScrubbing) {
        e.preventDefault()
        thumbnailImg.src = previewImgSrc
        timelineContainer.style.setProperty("--progress-position", percent)
      }*/
    }
    
    // Playback Speed
    speedBtn.addEventListener("click", changePlaybackSpeed)
    
    function changePlaybackSpeed() {
      let newPlaybackRate = video.playbackRate + 0.25
      if (newPlaybackRate > 2) newPlaybackRate = 0.25
      video.playbackRate = newPlaybackRate
      speedBtn.textContent = `${newPlaybackRate}x`
    }
    
    // Captions
    const captions = video.textTracks[0]
    captions.mode = "hidden"
    
    captionsBtn.addEventListener("click", toggleCaptions)
    
    function toggleCaptions() {
      const isHidden = captions.mode === "hidden"
      captions.mode = isHidden ? "showing" : "hidden"
      videoContainer.classList.toggle("captions", isHidden)
    }
    
    // Duration
    video.addEventListener("loadeddata", () => {
      totalTimeElem.textContent = formatDuration(video.duration)
    })
    
    video.addEventListener("timeupdate", () => {
      currentTimeElem.textContent = formatDuration(video.currentTime)
      const percent = video.currentTime / video.duration
      timelineContainer.style.setProperty("--progress-position", percent)
    })
    
    const leadingZeroFormatter = new Intl.NumberFormat(undefined, {
      minimumIntegerDigits: 2,
    })
    function formatDuration(time) {
      const seconds = Math.floor(time % 60)
      const minutes = Math.floor(time / 60) % 60
      const hours = Math.floor(time / 3600)
      if (hours === 0) {
        return `${minutes}:${leadingZeroFormatter.format(seconds)}`
      } else {
        return `${hours}:${leadingZeroFormatter.format(
          minutes
        )}:${leadingZeroFormatter.format(seconds)}`
      }
    }
    
    function skip(duration) {
      video.currentTime += duration
    }
    
    // Volume
    muteBtn.addEventListener("click", toggleMute)
    volumeSlider.addEventListener("input", e => {
      video.volume = e.target.value
      video.muted = e.target.value === 0
    })
    
    function toggleMute() {
      video.muted = !video.muted
    }
    
    video.addEventListener("volumechange", () => {
      volumeSlider.value = video.volume
      let volumeLevel
      if (video.muted || video.volume === 0) {
        volumeSlider.value = 0
        volumeLevel = "muted"
      } else if (video.volume >= 0.5) {
        volumeLevel = "high"
      } else {
        volumeLevel = "low"
      }
    
      videoContainer.dataset.volumeLevel = volumeLevel
    })
    
    // View Modes
    theaterBtn.addEventListener("click", toggleTheaterMode)
    fullScreenBtn.addEventListener("click", toggleFullScreenMode)
    miniPlayerBtn.addEventListener("click", toggleMiniPlayerMode)
    
    function toggleTheaterMode() {
      videoContainer.classList.toggle("theater")
    }
    
    function toggleFullScreenMode() {
      if (document.fullscreenElement == null) {
        videoContainer.requestFullscreen()
      } else {
        document.exitFullscreen()
      }
    }
    
    function toggleMiniPlayerMode() {
      if (videoContainer.classList.contains("mini-player")) {
        document.exitPictureInPicture()
      } else {
        video.requestPictureInPicture()
      }
    }
    
    document.addEventListener("fullscreenchange", () => {
      videoContainer.classList.toggle("full-screen", document.fullscreenElement)
    })
    
    video.addEventListener("enterpictureinpicture", () => {
      videoContainer.classList.add("mini-player")
    })
    
    video.addEventListener("leavepictureinpicture", () => {
      videoContainer.classList.remove("mini-player")
    })
    
    // Play/Pause
    playPauseBtn.addEventListener("click", togglePlay)
    video.addEventListener("click", togglePlay)
    
    function togglePlay() {
      video.paused ? video.play() : video.pause()
    }
    
    video.addEventListener("play", () => {
      videoContainer.classList.remove("paused")
    })
    
    video.addEventListener("pause", () => {
      videoContainer.classList.add("paused")
    })



    video.onended = (event) => {
        console.log('Video stopped either because 1) it was over, ' +'or 2) no further data is available.');
    };










    
  function humanized_time_span(date, ref_date, date_formats, time_units) {
    //Date Formats must be be ordered smallest -> largest and must end in a format with ceiling of null
    date_formats = date_formats || {
      past: [
        { ceiling: 60, text: "$seconds seconds ago" },
        { ceiling: 3600, text: "$minutes minutes ago" },
        { ceiling: 86400, text: "$hours hours ago" },
        { ceiling: 2629744, text: "$days days ago" },
        { ceiling: 31556926, text: "$months months ago" },
        { ceiling: null, text: "$years years ago" }      
      ],
      future: [
        { ceiling: 60, text: "in $seconds seconds" },
        { ceiling: 3600, text: "in $minutes minutes" },
        { ceiling: 86400, text: "in $hours hours" },
        { ceiling: 2629744, text: "in $days days" },
        { ceiling: 31556926, text: "in $months months" },
        { ceiling: null, text: "in $years years" }
      ]
    };
    //Time units must be be ordered largest -> smallest
    time_units = time_units || [
      [31556926, 'years'],
      [2629744, 'months'],
      [86400, 'days'],
      [3600, 'hours'],
      [60, 'minutes'],
      [1, 'seconds']
    ];
    
    date = new Date(date);
    ref_date = ref_date ? new Date(ref_date) : new Date();
    var seconds_difference = (ref_date - date) / 1000;
    
    var tense = 'past';
    if (seconds_difference < 0) {
      tense = 'future';
      seconds_difference = 0-seconds_difference;
    }
    
    function get_format() {
      for (var i=0; i<date_formats[tense].length; i++) {
        if (date_formats[tense][i].ceiling == null || seconds_difference <= date_formats[tense][i].ceiling) {
          return date_formats[tense][i];
        }
      }
      return null;
    }
    
    function get_time_breakdown() {
      var seconds = seconds_difference;
      var breakdown = {};
      for(var i=0; i<time_units.length; i++) {
        var occurences_of_unit = Math.floor(seconds / time_units[i][0]);
        seconds = seconds - (time_units[i][0] * occurences_of_unit);
        breakdown[time_units[i][1]] = occurences_of_unit;
      }
      return breakdown;
    }
  
    function render_date(date_format) {
      var breakdown = get_time_breakdown();
      var time_ago_text = date_format.text.replace(/\$(\w+)/g, function() {
        return breakdown[arguments[1]];
      });
      return depluralize_time_ago_text(time_ago_text, breakdown);
    }
    
    function depluralize_time_ago_text(time_ago_text, breakdown) {
      for(var i in breakdown) {
        if (breakdown[i] == 1) {
          var regexp = new RegExp("\\b"+i+"\\b");
          time_ago_text = time_ago_text.replace(regexp, function() {
            return arguments[0].replace(/s\b/g, '');
          });
        }
      }
      return time_ago_text;
    }
            
    return render_date(get_format());
  }

</script>


{% endblock %}
