{% extends 'index.html' %}
{% load static %}
{% load humanize %}

{% block content %}

{% include 'sidebar.html' %}


<div class="main-scroll">
    <div class="inner">
        {% for video in videos %}
            {% comment %} <form action="{% url 'watch' video.id %}" method="POST">
                {% csrf_token %}
                <button value="{{video.id}}" name="v"> {% endcomment %}
                    
                    <div class="video">
                        <a href="{% url 'watch' video.id %}">
                            <div class="video-img">
                                <img draggable="false" src="{% static 'images/placeholder.jpg' %}" data-real-src="{{video.image.url}}">
                                <span id="videourl" video-id="{{video.video.url}}">
                                    <p></p>
                                    <video src="{{video.video.url}}"></video>
                                </span>
                            </div>
                            <div class="video-detail">
                                <div class="video-left">
                                    <div class="video-author-img">
                                        {% if video.author == request.user %}
                                        <a href="{% url 'channel' request.user.channeluser.id %}"><img src="{% static 'images/author.png' %}" data-real-src="{{request.user.channeluser.channelimg.url}}"></a>
                                        {% else %}
                                        <a href="{% url 'author_channel' video.author.channeluser.channelname %}"><img src="{% static 'images/author.png' %}" data-real-src="{{video.author.channeluser.channelimg.url}}"></a>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="video-right">
                                    <h3>{{video.title}}...</h3>
                                    <div class="channel">
                                        {% if video.author == request.user %}
                                            <a href="{% url 'channel' request.user.channeluser.id %}">{{request.user.channeluser.channelname}}</a>
                                        {% else %}
                                            <a href="{% url 'author_channel' video.author.channeluser.channelname %}">{{video.author.channeluser.channelname}}</a>
                                        {% endif %}
                                        <svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none;"><g class="style-scope yt-icon"><path d="M12,2C6.5,2,2,6.5,2,12c0,5.5,4.5,10,10,10s10-4.5,10-10C22,6.5,17.5,2,12,2z M9.8,17.3l-4.2-4.1L7,11.8l2.8,2.7L17,7.4 l1.4,1.4L9.8,17.3z" class="style-scope yt-icon"></path></g></svg>
                                    </div>
                                    <div class="views">
                                        <span id="views">{{video.watched}}</span>
                                        <label>.</label>
                                        <span id="timeago">{{video.published | date:"Y-m-d H:i:s"}}</span>
                                        {{video.comments}}
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                
                {% comment %} </button>
            </form> {% endcomment %}
        {% endfor %}
    </div>
</div>





<script>


const formatCash = n => {
    if (n < 1e3) return n;
    if (n >= 1e3 && n < 1e6) return +(n / 1e3).toFixed(1) + "K";
    if (n >= 1e6 && n < 1e9) return +(n / 1e6).toFixed(1) + "M";
    if (n >= 1e9 && n < 1e12) return +(n / 1e9).toFixed(1) + "B";
    if (n >= 1e12) return +(n / 1e12).toFixed(1) + "T";
};

var views = document.querySelectorAll('.views #views');

for (let i=0; i<views.length; i++){
    views[i].innerHTML = formatCash(views[i].innerHTML) + " views";
}


</script>


{% endblock %}